var Space3D={};Space3D.Space=util.Class({parent:null,spirits:null,viewWidth:null,viewHeight:null,camX:0,camY:0,camZ:0,curX:0,curY:0,curZ:0,initialize:function(d,a){this.parent=document.getElementById(d);this.parent.innerHTML="";this.parent.style.backgroundImage="url(images/space3d/2.jpg)";this.parent.style.position="relative";this.parent.style.overflow="hidden";this.viewWidth=this.parent.offsetWidth;this.viewHeight=this.parent.offsetHeight;var c=document.createElement("img");c.setAttribute("src","images/space3d/333.png");c.style.position="absolute";c.style.left=0+"px";c.style.top=0+"px";c.style.width=660+"px";c.style.height=433+"px";c.style.zIndex=10000;c.style.visibility="visible";this.parent.appendChild(c);this.spirits=[];var b=this;setInterval(function(){b.run(b)},16);var b=this;if(window.addEventListener){this.parent.addEventListener("DOMMouseScroll",function(f){b.camZ+=(f.detail*40);return false},false)}if(this.parent.addEventListener){this.parent.addEventListener("mousemove",function(f){f=f||window.event;b.camX=0-(f.offsetX*2)+b.viewWidth;b.camY=-0+(f.offsetY*2)-b.viewHeight;return false},false)}else{if(this.parent.attachEvent){this.parent.attachEvent("onmousemove",function(f){f=f||window.event;b.camX=0-(f.clientX*2)+b.viewWidth;b.camY=-0-(f.clientY*2)+b.viewHeight;return false})}}this.parent.onmousewheel=function(){b.camZ+=(-event.wheelDelta);return false};this.curY=-2000},addImages:function(a){var c=null;var b=null;for(var d=0;d<a.length;d++){c=a[d];b=new Space3D.Spirit({x:c[0],y:c[1],z:c[2],img:c[3]});this.addImage(b)}},addImage:function(a){this.spirits.push(a);this.parent.appendChild(a.dom)},run:function(a){a.curX-=Math.round((a.camX+a.curX)*0.1);a.curY+=Math.round((a.camY-a.curY)*0.1);a.curZ+=Math.round((a.camZ-a.curZ)*0.1);a.display()},display:function(){var c=null;var a=1;var k=0;var e=0;var j=0;var g=0;var f=0;for(var d=0;d<this.spirits.length;d++){c=this.spirits[d];f=c.z-this.curZ;j=c.x-this.curX;g=c.y-this.curY;if(f>0){a=300/(300+(f*1));k=c.width*a;e=c.height*a;j=Math.floor((this.viewWidth*0.5)+(j*a)-(k*0.5));g=Math.floor((this.viewHeight*0.5)+(g*a)-e);c.dom.style.left=j+"px";c.dom.style.top=g+"px";c.dom.style.width=Math.ceil(k)+"px";c.dom.style.height=Math.ceil(e)+"px";c.dom.style.zIndex=Math.round(10000-f);c.dom.style.visibility="visible";var b=Math.max(0,Math.min(100,f));c.dom.style.opacity=b/100}else{c.dom.style.visibility="hidden"}}}});Space3D.Spirit=util.Class({x:0,y:0,z:0,width:0,height:0,dom:null,loaded:false,initialize:function(a){if(a){this.x=a.x?a.x:0;this.y=a.y?-a.y:0;this.z=a.z?a.z:0}this.dom=document.createElement("img");this.dom.setAttribute("src",a.img);this.dom.style.position="absolute";this.dom.style.visibility="hidden";var b=this;this.dom.onload=function(){b.width=b.dom.naturalWidth;b.height=b.dom.naturalHeight;b.dom.style.visibility="visible";b.loaded=true}}});